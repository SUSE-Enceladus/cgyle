#
# spec file for package python-cgyle
#
# Copyright (c) 2024 SUSE LLC
#
# All modifications and additions to the file contributed by third parties
# remain the property of their copyright owners, unless otherwise agreed
# upon. The license for this file, and modifications and additions to the
# file, is the same license as for the pristine package itself (unless the
# license for the pristine package is not an Open Source License, in which
# case the license is the MIT License). An "Open Source License" is a
# license that conforms to the Open Source Definition (Version 1.9)
# published by the Open Source Initiative.

# Please submit bugfixes or comments via https://bugs.opensuse.org/
#

Name:           python-cgyle
Version:        %%VERSION
Release:        0
Summary:        Cgyle - container preload
License:        GPL-3.0-or-later
Group:          System/Management
Source:         %{name}.tar.gz
Source1:        %{name}-rpmlintrc
BuildRoot:      %{_tmppath}/%{name}-%{version}-build
BuildRequires:  python311-poetry-core >= 1.2.0
BuildRequires:  python311-build
BuildRequires:  python311-installer
BuildRequires:  python311-wheel
BuildRequires:  python311-docopt >= 0.6.2
BuildRequires:  python311-requests
BuildRequires:  python311-setuptools
BuildRequires:  python311-PyYAML
BuildRequires:  python311-pip
BuildRequires:  python-rpm-macros
Requires:       python311
Requires:       python311-docopt
Requires:       python311-requests
Requires:       python311-setuptools
Requires:       python311-PyYAML
Requires:       skopeo
Requires:       podman
BuildArch:      noarch

%description
Tooling for the pubcloud team. Allows to pre-populate
containers in a distribution registry

%prep
%autosetup -n cgyle-%{version}

# Temporarily switch things back to docopt for everything but Fedora 41+
# FIXME: Drop this hack as soon as we can...
%if ! (0%{?fedora} >= 41 || 0%{?rhel} >= 10)
sed -e 's/docopt-ng.*/docopt = ">=0.6.2"/' -i pyproject.toml
%endif

# Build application wheel
%python311_pyproject_wheel
#%{__python3} -m build --no-isolation --wheel

%install
%python311_pyproject_install
#%{__python3} -m installer --destdir %{buildroot} %{?is_deb:--no-compile-bytecode} dist/*.whl

%files
%defattr(-,root,root,-)
%dir %{python311_sitelib}/cgyle
%{python311_sitelib}/*
%{_bindir}/*

%changelog
